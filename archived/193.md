# pringBoot + PostgreSQL + Hibernate ) ê°„ë‹¨í•œ ê²Œì‹œíŒ ë§Œë“¤ê¸°

## Intro

ì•ìœ¼ë¡œ ë§¡ì„ í”„ë¡œì íŠ¸ì—ì„œ SpringBoot ì™€ PostgreSQL ê·¸ë¦¬ê³  Hibernateë¥¼ ê¸°ìˆ ìŠ¤íƒìœ¼ë¡œ ì‚¬ìš©í•˜ê²Œ ë  ê²ƒ ê°™ìŠµë‹ˆë‹¤.

ì—¬íƒœ ë°°ì› ë˜ Spring Legacy Project + Oracle Database + Mybatis í™˜ê²½ì—ì„œ ì¡°ê¸ˆì”©ì€ ë‹¬ë¼ ì§€ê² ì§€ë§Œ, í¬ê²Œ ë‹¤ë¥¼ ê²ƒì€ ì—†ê¸° ë•Œë¬¸ì— ê¸ˆë°© ì ì‘ í•  ìˆ˜ ìˆì„ ê²ƒì´ë¼ê³  ë¯¿ìŠµë‹ˆë‹¤.

ê·¸ë˜ë„ ì¡°ê¸ˆì´ë¼ë„ ë¹¨ë¦¬ í•´ë‹¹ ê¸°ìˆ ë“¤ì— ëŒ€í•œ ë§‰ì—°í•¨ì„ í•´ì†Œí•˜ê³ , ì—…ë¬´ì— ëŒ€í•œ ì¤€ë¹„ë¥¼ ê°–ì¶”ê³  ì‹¶ì–´ í‹ˆí‹ˆì´ ì‹œê°„ë‚˜ëŠ” ëŒ€ë¡œ ê°€ì¥ ê¸°ë³¸ì ì¸ ê²Œì‹œíŒì„ ë§Œë“¤ì–´ ë³´ì•˜ìŠµë‹ˆë‹¤. ë°ì´í„° ê²€ì¦ ê³¼ì •ì´ ì—†ê³  í™”ë©´ êµ¬ì„±ì´ íˆ¬ë°•í•˜ì§€ë§Œ, ê·¸ ë§Œí¼ ì‰¬ìš´ ì½”ë“œë¡œ ê°„ë‹¨í•˜ê²Œ ì‘ì„± í•´ ë³´ì•˜ìŠµë‹ˆë‹¤.

##  Body 

ì œì¼ ë¨¼ì € í• ì¼ì€ ë°ì´í„° ë² ì´ìŠ¤ êµ¬ì¶•ì…ë‹ˆë‹¤.

PostgreSQL ì´ ì¤€ë¹„ ë˜ì–´ìˆë‹¤ë©´ ê·¸ëŒ€ë¡œ ì‚¬ìš© í•˜ì‹œë©´ ë˜ê³ , í˜¹ì‹œ ì´ë²ˆê¸°íšŒì— Dockerì— ì„¤ì¹˜ í•´ ë³¼ ìƒê°ì´ì‹œê±°ë‚˜ ì•„ì§ PostgreSQLì´ ì¤€ë¹„ê°€ ë˜ì–´ ìˆì§€ ì•Šìœ¼ì‹œë©´

ğŸ’» Windows

>  https://shanepark.tistory.com/188

ğŸ’» MacOS

>  https://shanepark.tistory.com/186

https://shanepark.tistory.com/194

> MacOS ) m1 ë§¥ë¶ docker ì„¤ì¹˜í•˜ê¸° + ê°€ìƒí™˜ê²½ì— postgreSQL ë„ì›Œ ë³´ê¸°

 

ê°ì ë³¸ì¸ì˜ ìš´ì˜ì²´ì œì— ë§ê²Œ postgreSQL ì„œë²„ë¥¼ ë¨¼ì € êµ¬ì¶• í•´ ì£¼ì„¸ìš”. 

 

ë°ì´í„°ë² ì´ìŠ¤ ì„œë²„ë¥¼ êµ¬ì¶• í•œ í›„ì—ëŠ” board í…Œì´ë¸”ì„ ì•„ë˜ì™€ ê°™ì´ ìƒì„±í•´ì¤ë‹ˆë‹¤. serial íƒ€ì…ì€ ìë™ìœ¼ë¡œ 1ì”© ì¦ê°€í•˜ëŠ” PK ê°’ì„ ë§Œë“¤ë„ë¡ í•´ì¤ë‹ˆë‹¤. í…Œì´ë¸” ë§Œë“¤ê³  í…ŒìŠ¤íŠ¸ìš©ìœ¼ë¡œ ë°ì´í„°ë„ ëª‡ê°œ ë„£ì–´ì£¼ì„¸ìš”.

```xml
CREATE TABLE public.board (
	boardno serial NOT NULL,
	title varchar NULL,
	"content" varchar NULL,
	writer varchar NULL,
	CONSTRAINT board_pk PRIMARY KEY (boardno)
);
```

 

ì œ ê²Œì‹œíŒì˜ ë°ì´í„°ì¸ë° ë”±íˆ í•„ìš”ëŠ” ì—†ê² ì§€ë§Œ ê¸°ë³¸ ë°ì´í„°ë¡œ ì‚¬ìš©í•˜ê³  ì‹¶ìœ¼ë©´ ì•„ë˜ ì¿¼ë¦¬ë¥¼ ì‹¤í–‰ í•´ì„œ ë°ì´í„° ì¶”ê°€ í•˜ì…”ë„ ë©ë‹ˆë‹¤.

```sql
INSERT INTO public.board (title,"content",writer) VALUES
	 ('2ë²ˆì§¸ ê¸€ ì œëª©','2ë²ˆì§¸ ë‚´ìš©','2ë²ˆì‘ì„±ì'),
	 ('ìƒˆê¸€','ìƒˆê¸€ ì¨ë´…ë‹ˆë‹¤.','ìƒˆê¸€ë§¨'),
	 ('ê¸€ ìˆ˜ì •','ìˆ˜ì •ë„ ì˜ë©ë‹ˆë‹¤.','ìˆ˜ì •ë§¨'),
	 ('1ë²ˆì§¸ ê¸€ ì œëª©','1ë²ˆì§¸ ë‚´ìš©,ë‚´ìš©','1ë²ˆì‘ì„±ì');
```

 

ë°ì´í„°ë² ì´ìŠ¤ê°€ ì¤€ë¹„ ë˜ì—ˆìœ¼ë©´ ì´ì œ í”„ë¡œì íŠ¸ë¥¼ ìƒì„± í•´ ë³´ê² ìŠµë‹ˆë‹¤.

 

Spring Starter Projectë¥¼ ìƒì„±í•˜ê² ìŠµë‹ˆë‹¤.

 

![img](https://raw.githubusercontent.com/ShanePark/mdblog/main/archived/193.assets/img-20230414222906693.webp)



 

 

ì›í•˜ëŠ” Name, Group, Artifact, ë°”ì ë²„ì „ ë“±ì„ ì…ë ¥ í•©ë‹ˆë‹¤. Maven, Gradle ë¬´ê´€ í•©ë‹ˆë‹¤.

ì €ëŠ” Maven ì€ ì¨ë´¤ëŠ”ë° Gradleì„ ê±°ì˜ ì•ˆì¨ë´ì„œ Gradle ë¡œ í”„ë¡œì íŠ¸ë¥¼ ë§Œë“¤ì–´ ë³´ì•˜ëŠ”ë°ìš”, Mavenìœ¼ë¡œ ìƒì„±í•´ë„ ë¬´ê´€í•©ë‹ˆë‹¤. 



![img](https://raw.githubusercontent.com/ShanePark/mdblog/main/archived/193.assets/img-20230414222906678-1478946.webp)



Spring ë²„ì „ê³¼ ì‚¬ìš©í•  ê¸°ëŠ¥ë“¤ì„ ì„ íƒ í•©ë‹ˆë‹¤.

Web Project ê¸° ë•Œë¬¸ì— Spring Web, ê·¸ë¦¬ê³  postgreSQL ì„ ì‚¬ìš©í•˜ê¸° ë•Œë¬¸ì— PostgreSQL Driverë¥¼ ì¶”ê°€í•˜ê³  Hibernate ì‚¬ìš©ì„ ìœ„í•´ Spring Data JPA, ê·¸ë¦¬ê³  Lombokì„ í•œë²ˆ ì¶”ê°€ í•´ ë³´ì•˜ìŠµë‹ˆë‹¤. ì‚¬ì§„ìƒì—ëŠ” ì—†ì§€ë§Œ Thymeleafë„ ì¶”ê°€í•´ì£¼ì„¸ìš”.



![img](https://raw.githubusercontent.com/ShanePark/mdblog/main/archived/193.assets/img-20230414222906678.webp)



 

ì´ì œ Finish ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ í”„ë¡œì íŠ¸ê°€ ìƒì„±ë©ë‹ˆë‹¤.



![img](https://raw.githubusercontent.com/ShanePark/mdblog/main/archived/193.assets/img-20230414222906680.webp)



 

Template Engineì€ Thymeleafë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤. ì €ëŠ” ì•„ê¹Œ ê¹Œë¨¹ê³  ì•ˆë„£ì–´ì„œ dependenciesì— ì¶”ê°€í–ˆìŠµë‹ˆë‹¤.

```xml
implementation 'org.springframework.boot:spring-boot-starter-thymeleaf'Copy
```



![img](https://raw.githubusercontent.com/ShanePark/mdblog/main/archived/193.assets/img-20230414222906666.webp)



 

ì „ì²´ build.gradle ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.

```xml
plugins {
	id 'org.springframework.boot' version '2.5.3'
	id 'io.spring.dependency-management' version '1.0.11.RELEASE'
	id 'java'
}
 
group = 'com.shanep'
version = '0.0.1-SNAPSHOT'
sourceCompatibility = '1.8'
 
configurations {
	compileOnly {
		extendsFrom annotationProcessor
	}
}
 
repositories {
	mavenCentral()
}
 
dependencies {
	implementation 'org.springframework.boot:spring-boot-starter-data-jpa'
	implementation 'org.springframework.boot:spring-boot-starter-web'
	implementation 'org.springframework.boot:spring-boot-starter-thymeleaf'
	compileOnly 'org.projectlombok:lombok'
	runtimeOnly 'org.postgresql:postgresql'
	annotationProcessor 'org.projectlombok:lombok'
	testImplementation 'org.springframework.boot:spring-boot-starter-test'
}
 
test {
	useJUnitPlatform()
}
```

 

ì´ì œ application.propertiesì— DB ì ‘ì† ê´€ë ¨ ì •ë³´ë¥¼ ë“±ë¡í•´ì¤ë‹ˆë‹¤. PUT, DELETE ë©”ì„œë“œë¥¼ ì‚¬ìš© í•˜ê¸° ìœ„í•´ hiddenmethod filterë„ ë„£ì–´ì¤¬ìŠµë‹ˆë‹¤. 

```xml
spring.datasource.url=jdbc:postgresql://localhost:5432/study
spring.datasource.username=testuser
spring.datasource.password=test
spring.mvc.hiddenmethod.filter.enabled=true
```

 

ì¼ë‹¨ RESTful API ë°©ì‹ìœ¼ë¡œ ë°±ì—”ë“œë¥¼ ë§Œë“¤ì–´ ë³´ê² ìŠµë‹ˆë‹¤. Package êµ¬ì¡°ëŠ” ì•„ë˜ì™€ ê°™ì´ ë§Œë“¤ì—ˆìŠµë‹ˆë‹¤.



![img](https://raw.githubusercontent.com/ShanePark/mdblog/main/archived/193.assets/img-20230414222906679.webp)



 

 ê²Œì‹œíŒ Modelì€ Board ë¼ëŠ” ì´ë¦„ìœ¼ë¡œ ë§Œë“¤ì–´ ë’€ìŠµë‹ˆë‹¤.

PKë¥¼ AutoIncrement ë¡œ í–ˆì„ ê²½ìš° ë¬¸ì œê°€ ë°œìƒí•´ @GeneratedValue(strategy ë¥¼ ë³€ê²½ í•´ ì£¼ì—ˆëŠ”ë°ìš”, ì—¬ê¸°ì— ëŒ€í•œ ìì„¸í•œ ë‚´ìš©ì€ ì´ë™ìš±ë‹˜ì˜ ë¸”ë¡œê·¸ https://jojoldu.tistory.com/295 ì— ì˜ ì„¤ëª…ì´ ë˜ì–´ ìˆìŠµë‹ˆë‹¤.

ì•„ì£¼ ê¸°ë³¸ì ì¸ í…ŒìŠ¤íŠ¸ í˜•ì‹ì´ë¼ ì–´ë…¸í…Œì´ì…˜ì´ ì ê²Œ ë‹¬ë ¤ ìˆì§€ë§Œ ì‹¤ì œë¡œëŠ” ë°ì´í„° ê²€ì¦ì´ë‚˜ Not Null ë“±ì˜ ì˜µì…˜ì´ ëª¨ë‘ ìˆì–´ì•¼ í•©ë‹ˆë‹¤.

```xml
package com.shanep.model;
 
import javax.persistence.Entity;
import javax.persistence.GeneratedValue;
import javax.persistence.GenerationType;
import javax.persistence.Id;
import javax.persistence.Table;
 
import lombok.Getter;
import lombok.Setter;
import lombok.ToString;
 
@Entity
@Table(name="board")
@Getter
@Setter
@ToString
public class Board {
	
	@Id
	@GeneratedValue(strategy = GenerationType.IDENTITY)
	private Integer boardno;
	
	private String title;
	private String content;
	private String writer;
	
}
```

 

ê·¸ ì™¸ì— ì‘ë‹µ ë°ì´í„°ë¥¼ ë³´ë‚´ê¸° ìœ„í•´ Result classì™€ ErrorResponse class ë„ ë§Œë“¤ì–´ ì£¼ì—ˆìŠµë‹ˆë‹¤.

```xml
package com.shanep.model;
 
import lombok.Getter;
import lombok.Setter;
import lombok.ToString;
 
@Getter
@Setter
public class Result {
	private ErrorResponse error;
	private Object payload;
}
```

 

```xml
package com.shanep.model;
 
import lombok.Getter;
import lombok.Setter;
import lombok.ToString;
 
@Getter
@Setter
public class ErrorResponse {
	private Integer code;
	private String message;
	
	public ErrorResponse(String message) {
		this.message = message;
	}
	
}
```

 

Repository ëŠ” ê°„ë‹¨í•˜ê²Œ ì „ì²´ ì¡°íšŒí•˜ëŠ” ë©”ì„œë“œë§Œ ì¶”ê°€ í•´ ì£¼ì—ˆìŠµë‹ˆë‹¤.

```xml
package com.shanep.repositories;
 
import java.util.List;
 
import org.springframework.data.jpa.repository.JpaRepository;
import org.springframework.stereotype.Repository;
 
import com.shanep.model.Board;
 
@Repository
public interface BoardRepository extends JpaRepository<Board, Integer> {
	public List<Board> findAllByOrderByBoardnoDesc();
	
}
```

Hibernate ëŠ” ìœ„ì˜ ë©”ì„œë“œ ëª…ì„ ë°”íƒ•ìœ¼ë¡œ select * from board order by boardno desc; ì¿¼ë¦¬ë¥¼ ì•Œì•„ì„œ ë§Œë“¤ì–´ì¤ë‹ˆë‹¤.

 

ì„œë¹„ìŠ¤ ì¸í„°í˜ì´ìŠ¤ë¥¼ ë§Œë“¤ì–´ì£¼ê³ 

```xml
package com.shanep.service;
 
import com.shanep.model.Board;
import com.shanep.model.Result;
 
public interface BoardService {
	public Result createBoard(Board board);
	public Result retrieveBoardList();
	public Result retrieveBoard(int boardno);
	public Result updateBoard(Board board);
	public Result deleteBoard(int boardno);
}
```

 

ì•„ì£¼ ê¸°ë³¸ì ì¸ C/R/U/D restapië¥¼ ë§Œë“¤ì–´ ë³´ì•˜ìŠµë‹ˆë‹¤.

```xml
package com.shanep.controller;
 
import org.apache.logging.log4j.LogManager;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.web.bind.annotation.DeleteMapping;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.ModelAttribute;
import org.springframework.web.bind.annotation.PathVariable;
import org.springframework.web.bind.annotation.PostMapping;
import org.springframework.web.bind.annotation.PutMapping;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestParam;
import org.springframework.web.bind.annotation.RestController;
import com.shanep.model.Board;
import com.shanep.model.Result;
import com.shanep.repositories.BoardRepository;
import com.shanep.service.BoardService;
 
@RestController
@RequestMapping(value="restapi/board")
public class BoardRestController {
	
	private static final org.apache.logging.log4j.Logger logger = LogManager.getLogger(BoardRestController.class);
 
	@Autowired
	BoardRepository repository;
	
	@Autowired
	BoardService boardService;
	
	@GetMapping
	public Result retrieveBoardList() {
		Result result = boardService.retrieveBoardList();
		return result;
	}
	
	@GetMapping("/{boardno}")
	public Result retrieveBoard(@PathVariable Integer boardno) {
		Result result = boardService.retrieveBoard(boardno);
		return result;
	}
	
	@PostMapping
	public Result createBoard(@ModelAttribute Board board) {
		Result result = boardService.createBoard(board);
		return result;
	}
	
	@PutMapping
	public Result updateBoard(@ModelAttribute Board board) {
		Result result = boardService.updateBoard(board);
		return result;
	}
	
	@DeleteMapping
	public Result deleteBoard(@RequestParam int boardno) {
		Result result = boardService.deleteBoard(boardno);
		return result;
	}
	
}
```

 

ì„œë¹„ìŠ¤ êµ¬í˜„ì²´ë„ ê°„ë‹¨í•˜ê²Œ ë§Œë“­ë‹ˆë‹¤.

```xml
package com.shanep.service;
 
import java.util.List;
import java.util.Optional;
 
import org.apache.logging.log4j.LogManager;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;
 
import com.shanep.enumpkg.ServiceResult;
import com.shanep.model.Board;
import com.shanep.model.ErrorResponse;
import com.shanep.model.Result;
import com.shanep.repositories.BoardRepository;
 
@Service
public class BoardServiceImpl implements BoardService{
	
	private static final org.apache.logging.log4j.Logger logger = LogManager.getLogger(BoardServiceImpl.class);
 
	@Autowired
	BoardRepository repository;
	
	public Result updateBoard(Board board) {
		Optional<Board> search = repository.findById(board.getBoardno());
		Result result = new Result();
		if(search.isPresent()) {
			board = repository.save(board);
			result.setPayload(board);
		}else {
			result.setError(new ErrorResponse(ServiceResult.NOTEXIST.toString()));
		}
		return result;
	}
	
	public Result deleteBoard(int boardno) {
		Result result = new Result();
		boolean isPresent = repository.findById(boardno).isPresent();
		if(!isPresent) {
			result.setError(new ErrorResponse(ServiceResult.NOTEXIST.toString()));
		}else {
			repository.deleteById(boardno);
		}
		return result;
	}
 
	@Override
	public Result createBoard(Board board) {
		board = repository.save(board);
		Result result = new Result();
		result.setPayload(board);
		return result;
	}
 
	@Override
	public Result retrieveBoardList() {
		List<Board> list = repository.findAllByOrderByBoardnoDesc();
		Result result = new Result();
		result.setPayload(list);
		return result;
	}
 
	@Override
	public Result retrieveBoard(int boardno) {
		Optional<Board> optionalBoard = repository.findById(boardno);
		Result result = new Result();
		if(optionalBoard.isPresent()) {
			result.setPayload(optionalBoard.get());
		}else {
			result.setError(new ErrorResponse(ServiceResult.NOTEXIST.toString()));
		}
		return result;
	}
 
}
```

 

ì´ê±¸ë¡œ ë°±ì—”ë“œëŠ” ëª¨ë‘ ì¤€ë¹„ë˜ì—ˆìŠµë‹ˆë‹¤. ì„œë²„ë¥¼ ì‹¤í–‰í•´ì„œ í…ŒìŠ¤íŠ¸ í•´ë´…ë‹ˆë‹¤.

API testëŠ” POSTMAN ì„ ì´ìš©í–ˆìŠµë‹ˆë‹¤. ì‚¬ì‹¤ GET ë©”ì„œë“œë§Œ í…ŒìŠ¤íŠ¸ í•´ ë³´ë ¤ë©´ í¬ë¡¬ì— ê·¸ëƒ¥ í•´ë‹¹ ì£¼ì†Œë¥¼ ë„£ì–´ë„ í…ŒìŠ¤íŠ¸ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.



![img](https://raw.githubusercontent.com/ShanePark/mdblog/main/archived/193.assets/img-20230414222906719.webp)



í•´ë‹¹ ì£¼ì†Œë¡œ í…ŒìŠ¤íŠ¸ í–ˆì„ ë•Œ ì €ì¥ëœ ëª¨ë“  ëª©ë¡ì„ ë°›ì•„ì™”ìŠµë‹ˆë‹¤.

 

ì´ë²ˆì—” POST ìš”ì²­ìœ¼ë¡œ ê¸€ì„ ë“±ë¡í•´ë´…ë‹ˆë‹¤. 

ì½”ë“œ ì‘ì„±í•œ ëŒ€ë¡œ, í•´ë‹¹ ë°ì´í„°ëŒ€ë¡œ insert í•˜ê³  í•´ë‹¹ board ê°ì²´ë¥¼ ê·¸ëŒ€ë¡œ return í•©ë‹ˆë‹¤.



![img](https://raw.githubusercontent.com/ShanePark/mdblog/main/archived/193.assets/img-20230414222906656.webp)



error ê°€ ì—†ê¸° ë•Œë¬¸ì— error ëŠ” null ì…ë‹ˆë‹¤.

 

PUT ë©”ì„œë“œë¡œ ìˆ˜ì • í•´ ë³´ê² ìŠµë‹ˆë‹¤.



![img](https://raw.githubusercontent.com/ShanePark/mdblog/main/archived/193.assets/img-20230414222906687.webp)



ìˆ˜ì •ë„ ì˜ ë˜ë„¤ìš”.

 

ë§ˆì§€ë§‰ìœ¼ë¡œ DELETE ë©”ì„œë“œë¡œ ì‚­ì œ í•´ ë³´ê² ìŠµë‹ˆë‹¤.



![img](https://raw.githubusercontent.com/ShanePark/mdblog/main/archived/193.assets/img-20230414222906709.webp)



 

ì‚­ì œ ì„±ê³µì— ëŒ€í•œ ì‘ë‹µì„ ë”°ë¡œ ì•ˆë§Œë“¤ì–´ì„œ ë¶ˆí¸í•˜ë„¤ìš”. error ê°€ ì—†ìœ¼ë©´ ì„±ê³µí•œê±¸ë¡œ ê°„ì£¼í•  ìˆ˜ë„ ìˆê³ , ì„±ê³µì— ëŒ€í•œ ì‘ë‹µì„ ë”°ë¡œ ë§Œë“œëŠ” ê²ƒë„ ì¢‹ì„ ê²ƒ ê°™ìŠµë‹ˆë‹¤. DBë¥¼ í™•ì¸í•˜ë‹ˆ ì˜ ì‚­ì œ ë˜ì—ˆìŠµë‹ˆë‹¤.

 

ìœ„ì˜ API ë“¤ì„ ë°”íƒ•ìœ¼ë¡œ ê²Œì‹œíŒ í˜ì´ì§€ë„ ê°„ëµí•˜ê²Œ ë§Œë“¤ì–´ ë³´ì•˜ëŠ”ë°ìš”, ì‚¬ì‹¤ API ì„œë²„ì™€ WAS ì„œë²„ê°€ ê°™ì´ ìˆê¸° ë•Œë¬¸ì— ìš”ì²­ì„ ì‹¤ì œ RESTAPIë¡œ ë³´ë‚´ëŠ” ê±´ ê²Œì‹œíŒ ëª©ë¡ ë³´ì—¬ì¤„ë•Œ fetchë¡œ ë°›ì•„ì˜¬ë•Œ ë”± í•œë²ˆ ì‚¬ìš©í–ˆìŠµë‹ˆë‹¤. ê·¸ ì™¸ì—ëŠ” ëª¨ë‘ ì„œë¹„ìŠ¤ì—ì„œ ë°ì´í„° í˜¸ì¶œí•´ ë§Œë“¤ì–´ ë³´ì•˜ìŠµë‹ˆë‹¤.



![img](https://raw.githubusercontent.com/ShanePark/mdblog/main/archived/193.assets/img-20230414222906695-1478946.webp)



ë·°ëŠ” ì´ë ‡ê²Œ êµ¬ì„±í–ˆìŠµë‹ˆë‹¤. 

ëª¨ë“  ê²Œì‹œíŒì— ëŒ€í•œ ì»¨íŠ¸ë¡¤ëŸ¬ëŠ” ì•„ë˜ ì½”ë“œ í•˜ë‚˜ë¡œ ë‹¤ ì²˜ë¦¬í–ˆìŠµë‹ˆë‹¤.

```java
package com.shanep.controller;
 
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.DeleteMapping;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.ModelAttribute;
import org.springframework.web.bind.annotation.PathVariable;
import org.springframework.web.bind.annotation.PostMapping;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.servlet.ModelAndView;
 
import com.shanep.model.Board;
import com.shanep.service.BoardService;
 
@Controller
public class UrlController {
	
	@Autowired
	BoardService boardService;
	
	@GetMapping(value={"/","board"})
	public ModelAndView boardList(ModelAndView mav) {
		mav.setViewName("page/board");
		return mav;
	}
	
	@GetMapping("board/{boardno}")
	public ModelAndView board(
			ModelAndView mav
			, @PathVariable int boardno) {
		mav.setViewName("page/view");
		Board board = (Board) boardService.retrieveBoard(boardno).getPayload();
		mav.addObject(board);
		return mav;
	}
	@GetMapping("board/{boardno}/delete")
	public ModelAndView delete(
			ModelAndView mav
			, @PathVariable int boardno) {
		mav.setViewName("redirect:/");
		boardService.deleteBoard(boardno);
		return mav;
	}
	
	@GetMapping("board/write")
	public ModelAndView write(ModelAndView mav) {
		mav.setViewName("page/write");
		return mav;
	}
	@PostMapping("board/write")
	public ModelAndView writeView(
			ModelAndView mav
			,@ModelAttribute Board board) {
		mav.setViewName("redirect:/");
		boardService.createBoard(board);
		return mav;
	}
	
	@GetMapping("board/{boardno}/edit")
	public ModelAndView editView(
			ModelAndView mav
			, @PathVariable int boardno) {
		mav.setViewName("page/edit");
		Board board = (Board) boardService.retrieveBoard(boardno).getPayload();
		mav.addObject(board);
		return mav;
	}
	@PostMapping("board/{boardno}/edit")
	public ModelAndView edit(
			ModelAndView mav
			, @PathVariable int boardno
			, @ModelAttribute Board board) {
		mav.setViewName(String.format("redirect:/board/%d", boardno));
		boardService.updateBoard(board);
		return mav;
	}
}
```

 

ê·¸ ì™¸ ê°ê° board.htmlì€ ê²Œì‹œíŒ ëª©ë¡ . write.htmlì€ ê²Œì‹œíŒ ê¸€ ì“°ê¸°, edit.htmlì€ ìˆ˜ì •. ê·¸ë¦¬ê³  view.html ì€ í•œê°œì˜ ê²Œì‹œíŒ ê¸€ í™•ì¸ì„ í•  ìˆ˜ ìˆë„ë¡ êµ¬ì„± í•´ ë³´ì•˜ìŠµë‹ˆë‹¤. Thymeleafë¥¼ ì´ìš©í•´ ì‘ì„±í–ˆìŠµë‹ˆë‹¤.

 

board.html

```xml
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorator="layout/layout">
 
<head>
<meta charset="UTF-8">
<style>
	table{
		border:1px solid black;
		font-size : 1.5em;
	}
	tbody tr:nth-child(1){
		width : 50px;
	}
	tbody tr:nth-child(2){
		width : 100px;
	}
	tbody tr:nth-child(3){
		width : 50px;
	}
	button{
		margin-top : 10px;
		margin-left : 400px;
	}
</style>
<title>board</title>
</head>
<script>
	fetch('/restapi/board', {
		method:'GET'
	}).then(function (response) {
		return response.json();
	}).then(function (result){
			if(!result.error){
				let data = result.payload;
				let table = document.getElementById('board');
				for(let i in data){
					board = data[i];
					let row = table.insertRow(parseInt(i)+1);
					let cell0 = row.insertCell(0);
					let cell1 = row.insertCell(1);
					let cell2 = row.insertCell(2);
					let url = '/board/' + board.boardno;
					cell0.innerHTML = board.boardno;
					cell1.innerHTML = '<a href="'+url+'">'+board.title + '</a>';
					cell2.innerHTML = board.writer;
				}
			}
	}).catch(function (err){
		console.warn(err);
	})
</script>
<body>
	<table id="board">
		<thead>
			<tr>
				<th>ê¸€ë²ˆí˜¸</th>
				<th>ì œëª©</th>
				<th>ì‘ì„±ì</th>
			</tr>
		</thead>
		<tbody>
		</tbody>
		<tfoot>
			<tr>
				<td colspan="3">
					<button onclick="location.href = '/board/write';">ê¸€ ì‘ì„±</button>
				</td>
			</tr>
		</tfoot>
	</table>
</body>
</html>
```

 

write.html

```xml
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<style>
	form div{
		margin : 5px;
	}
	label{
		width : 50px;
		display : inline-block;
	}
	.btns{
		margin-left : 100px;
	}
</style>
<title>Insert title here</title>
</head>
<body>
	<h1>ê²Œì‹œíŒ ê¸€ ì‘ì„±</h1>
	<form id="writeForm" action="" method="post">
		<div>
			<label for="title">ì œëª©</label>
			<input type="text" id="title" name="title">
		</div>
		<div>
			<label for="writer">ì‘ì„±ì</label>
			<input type="text" id="writer" name="writer">
		</div>
		<div>
			<label for="content">ë‚´ìš©</label>
			<textarea id="content" name="content"></textarea>
		</div>
	</form>
	<div class="btns">
		<button type="button" onclick="location.href = '/board';">ì·¨ì†Œ</button>
		<button type="submit" form="writeForm">ì €ì¥</button>
	</div>
</body>
</html>
```

 

edit.html

```xml
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<style>
	form div{
		margin : 5px;
	}
	label{
		width : 50px;
		display : inline-block;
	}
	.btns{
		margin-left : 100px;
	}
</style>
<title>board</title>
</head>
<body>
	<h1>ê²Œì‹œíŒ ê¸€ ìˆ˜ì •</h1>
	<form id="editForm" method="post">
		<input th:value="${board.boardno}" hidden="hidden">
		<div>
			<label for="title">ì œëª©</label>
			<input type="text" id="title" name="title" th:value="${board.title}">
		</div>
		<div>
			<label for="writer">ì‘ì„±ì</label>
			<input type="text" id="writer" name="writer" th:value="${board.writer}">
		</div>
		<div>
			<label for="content">ë‚´ìš©</label>
			<textarea id="content" name="content" th:text="${board.content}">
			</textarea>
		</div>
	</form>
	<div class="btns">
		<button type="button" onclick="window.history.go(-1); return false;">ì·¨ì†Œ</button>
		<button type="submit" form="editForm">ì €ì¥</button>
	</div>
</body>
</html>
```

 

 

view.html

```xml
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
</head>
<body>
	<h1 th:text="${board.boardno}+'. '+${board.title}"></h1>
	<h3 th:text="'ì‘ì„±ì : ' + ${board.writer}"></h3>
	<p th:text="${board.content}"></p>
	<button onclick="location.href='/board'">ëª©ë¡ìœ¼ë¡œ</button>
	<button onclick="location.href=window.location.href+'/edit'">ìˆ˜ì •í•˜ê¸°</button>
	<button onclick="location.href=window.location.href+'/delete'">ì‚­ì œí•˜ê¸°</button>
</body>
</html>
```

 

ì´ì œ ê²°ê³¼ë¬¼ ì…ë‹ˆë‹¤. ê½¤ë‚˜ íˆ¬ë°•í•©ë‹ˆë‹¤.

 

http://localhost:8080/ ìœ¼ë¡œ ì ‘ì†í•˜ë©´ ì•„ë˜ì˜ í˜ì´ì§€ê°€ ë³´ì—¬ì§‘ë‹ˆë‹¤.



![img](https://raw.githubusercontent.com/ShanePark/mdblog/main/archived/193.assets/img-20230414222906695.webp)



 



![img](https://raw.githubusercontent.com/ShanePark/mdblog/main/archived/193.assets/img-20230414222906710.webp)



ê·¸ ì¤‘ í•œ ê¸€ì„ í´ë¦­í•´ ë“¤ì–´ê°€ë©´ ì´ì²˜ëŸ¼ ê¸€ ì œëª©, ì‘ì„±ì, ê¸€ ë‚´ìš©ì„ ë³´ì—¬ì¤ë‹ˆë‹¤. ëª©ë¡ìœ¼ë¡œ ëŒì•„ê°ˆ ìˆ˜ë„ ìˆìœ¼ë©° ê¸€ ìˆ˜ì •, ì‚­ì œê°€ ê°€ëŠ¥í•©ë‹ˆë‹¤.

 

ìˆ˜ì •í•˜ê¸°ë¥¼ í´ë¦­í•˜ë©´

![img](https://raw.githubusercontent.com/ShanePark/mdblog/main/archived/193.assets/img-20230414223137979.webp)



ì´ì²˜ëŸ¼ ê°„ë‹¨í•˜ê²Œ ê²Œì‹œíŒì„ ìˆ˜ì • í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. hidden íƒ€ì…ìœ¼ë¡œ form íƒœê·¸ ì•ˆì— ê²Œì‹œê¸€ ë²ˆí˜¸ê°€ ìˆ¨ê²¨ì ¸ ìˆë„ë¡ í•´ ë‘ì—ˆìŠµë‹ˆë‹¤.

 

ê²Œì‹œê¸€ ì‘ì„±ì€ ì•„ë˜ ì²˜ëŸ¼ ì‘ì„± í•´ ë‘ì—ˆìŠµë‹ˆë‹¤.



![img](https://raw.githubusercontent.com/ShanePark/mdblog/main/archived/193.assets/img-20230414222906712.webp)



 

ì •ë§ ê°„ë‹¨í•œ ê²Œì‹œíŒì„ ë§Œë“¤ì–´ ë³´ì•˜ëŠ”ë°ìš”, ë°ì´í„° ê²€ì¦ì´ë‚˜ ì˜ˆì™¸ ì²˜ë¦¬, ê·¸ë¦¬ê³  UX ê°œì„ ë“±ì˜ í•„ìš”í•œ ì‚¬í•­ë“¤ì´ ë‚¨ì•„ìˆì§€ë§Œ ê°„ë‹¨í•˜ê²Œ Spring Boot, PostgreSQL, Hibernateë¥¼ ì²´í—˜ í•´ ë³´ê¸° ìœ„í•´ ë§Œë“  í”„ë¡œì íŠ¸ê¸° ë•Œë¬¸ì— ì´ì •ë„ë¡œ ì¼ë‹¨ í¬ìŠ¤íŒ…ì„ ë§ˆì¹˜ê² ìŠµë‹ˆë‹¤.

 

í•´ë‹¹ í”„ë¡œì íŠ¸ì˜ ì½”ë“œëŠ” ì•„ë˜ ë§í¬ì—ì„œ ìì„¸íˆ í™•ì¸ í•˜ê±°ë‚˜ ë‹¤ìš´ ë°›ìœ¼ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ìˆ˜ê³ í•˜ì…¨ìŠµë‹ˆë‹¤.

https://github.com/Shane-Park/markdownBlog/tree/master/projects/postgresql

 